<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Examen </title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    </head>

    <body>
        <div class="jumbotron jumbotron-fluid">
            <div class="container">
                <h2> Listes D'item </h2>
            </div>
            <hr>
           

        
        </div>

        <div id="items"></div>

        <script type="text/javascript">
    function getData()
    {

	    var csv_data;          
	    var q = d3.queue()
		.defer(d3.json,'https://polemika.univ-paris8.fr/omk/api/items?item_set_id=2')
		.awaitAll(function(error, results) {
		    if (error) throw error;
		    csv_data=results;
		    console.log(csv_data);

		    showItems(results);

		});
	    }
    function showItems(data)
    {
      var Items= d3.select('#items').data(data);
        data[0].forEach(function(d, j){
        Items.append('div').attr('class','col-2');
          var card= Items.append('div').attr('class','col-5').style('text-align','center')
            .style('margin-bottom','10px')
            card.append('div').attr('class','card-header')
            .append('h5').text(d["o:id"]); 

          d3.queue().defer(d3.json, d["o:media"][0]['@id'])
            .awaitAll(function(error, results) {
            if (error) throw error;
            csv_data=results;
            
           var front = card.append('div').attr('class','card-body');
               front.append('h4').attr('class','card-title').text(d["o:title"]);
               front .append("img")
               .attr('src', csv_data[0]['o:thumbnail_urls']['large']);
            
        });



        Items.append('div').attr('class','col-2');
        });
        



    }



getData();


	    
	    
	    </script>
    </body>
</html>
